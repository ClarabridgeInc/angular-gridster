/*
 * angular-gridster
 * http://manifestwebdesign.github.io/angular-gridster
 *
 * @version: 0.13.5
 * @license: MIT
 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["angular"],b):"object"==typeof exports?module.exports=b(require("angular")):b(a.angular)}(this,function(a){"use strict";return a.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,pushOnDrop:!1,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,sparse:!1,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(b,c){function d(a){return{row:Math.round((a.offsetTop-e.margins[0])/e.curRowHeight),col:Math.round((a.offsetLeft-e.margins[1])/e.curColWidth),sizeY:Math.round((a.offsetHeight+e.margins[0])/e.curRowHeight),sizeX:Math.round((a.offsetWidth+e.margins[1])/e.curColWidth)}}var e=this;a.extend(this,b),this.resizable=a.extend({},b.resizable||{}),this.draggable=a.extend({},b.draggable||{});var f=!1;this.layoutChanged=function(){f||(f=!0,c(function(){f=!1,e.loaded&&e.floatItemsUp(),e.updateHeight(e.movingItem?e.movingItem.sizeY:0)},30))},this.grid=[],this.allItems=[],this.destroy=function(){this.grid&&(this.grid=[]),this.$element=null,this.allItems&&(this.allItems.length=0,this.allItems=null)},this.setOptions=function(b){if(b)if(b=a.extend({},b),b.draggable&&(a.extend(this.draggable,b.draggable),delete b.draggable),b.resizable&&(a.extend(this.resizable,b.resizable),delete b.resizable),a.extend(this,b),this.margins&&2===this.margins.length)for(var c=0,d=this.margins.length;c<d;++c)this.margins[c]=parseInt(this.margins[c],10),isNaN(this.margins[c])&&(this.margins[c]=0);else this.margins=[0,0]},this.canItemOccupy=function(a,b,c){return b>-1&&c>-1&&a.sizeX+c<=this.columns&&a.sizeY+b<=this.maxRows},this.autoSetItemPosition=function(a){for(var b=0;b<this.maxRows;++b)for(var c=0;c<this.columns;++c){var d=this.getItems(b,c,a.sizeX,a.sizeY,a);if(0===d.length&&this.canItemOccupy(a,b,c))return void this.putItem(a,b,c)}throw new Error("Unable to place item!")},this.getItems=function(a,b,c,d,e){var f=[];c&&d||(c=d=1),!e||e instanceof Array||(e=[e]);var g;if(!1===this.sparse)for(var h=0;h<d;++h)for(var i=0;i<c;++i)!(g=this.getItem(a+h,b+i,e))||e&&-1!==e.indexOf(g)||-1!==f.indexOf(g)||f.push(g);else for(var j=a+d-1,k=b+c-1,l=0;l<this.allItems.length;++l)!(g=this.allItems[l])||e&&-1!==e.indexOf(g)||-1!==f.indexOf(g)||!this.intersect(g,b,k,a,j)||f.push(g);return f},this.getBoundingBox=function(a){if(0===a.length)return null;if(1===a.length)return{row:a[0].row,col:a[0].col,sizeY:a[0].sizeY,sizeX:a[0].sizeX};for(var b=0,c=0,d=9999,e=9999,f=0,g=a.length;f<g;++f){var h=a[f];d=Math.min(h.row,d),e=Math.min(h.col,e),b=Math.max(h.row+h.sizeY,b),c=Math.max(h.col+h.sizeX,c)}return{row:d,col:e,sizeY:b-d,sizeX:c-e}},this.getElementBoundingBox=function(a){if(0===a.length)return null;if(1===a.length){var b=a[0].$element[0];return d(b)}for(var c=0,e=0,f=9999,g=9999,h=0,i=a.length;h<i;++h){var b=a[h].$element[0],j=d(b);f=Math.min(j.row,f),g=Math.min(j.col,g),c=Math.max(j.row+j.sizeY,c),e=Math.max(j.col+j.sizeX,e)}return{row:f,col:g,sizeY:c-f,sizeX:e-g}},this.intersect=function(a,b,c,d,e){return b<=a.col+a.sizeX-1&&c>=a.col&&d<=a.row+a.sizeY-1&&e>=a.row},this.removeItem=function(a){for(var b,c=0,d=this.grid.length;c<d;++c){var e=this.grid[c];if(e&&-1!==(b=e.indexOf(a))){e[b]=null;break}}this.sparse&&-1!==(b=this.allItems.indexOf(a))&&this.allItems.splice(b,1),this.layoutChanged()},this.getItem=function(a,b,c){!c||c instanceof Array||(c=[c]);for(var d=1;a>-1;){for(var e=1,f=b;f>-1;){var g=this.grid[a];if(g){var h=g[f];if(h&&(!c||-1===c.indexOf(h))&&h.sizeX>=e&&h.sizeY>=d)return h}++e,--f}--a,++d}return null},this.putItems=function(a){for(var b=0,c=a.length;b<c;++b)this.putItem(a[b])},this.putItem=function(a,b,c,d){if((void 0===b||null===b)&&(b=a.row,c=a.col,void 0===b||null===b))return void this.autoSetItemPosition(a);if(this.canItemOccupy(a,b,c)||(c=Math.min(this.columns-a.sizeX,Math.max(0,c)),b=Math.min(this.maxRows-a.sizeY,Math.max(0,b))),null!==a.oldRow&&void 0!==a.oldRow){var e=a.oldRow===b&&a.oldColumn===c,f=this.grid[b]&&this.grid[b][c]===a;if(e&&f)return a.row=b,void(a.col=c);var g=this.grid[a.oldRow];g&&g[a.oldColumn]===a&&delete g[a.oldColumn]}a.oldRow=a.row=b,a.oldColumn=a.col=c,this.moveOverlappingItems(a,d),this.grid[b]||(this.grid[b]=[]),this.grid[b][c]=a,this.sparse&&-1===this.allItems.indexOf(a)&&this.allItems.push(a),(this.movingItem===a||this.isGroupItem(a))&&this.floatItemUp(a),this.layoutChanged()},this.swapItems=function(a,b){this.grid[a.row][a.col]=b,this.grid[b.row][b.col]=a;var c=a.row,d=a.col;a.row=b.row,a.col=b.col,b.row=c,b.col=d},this.moveOverlappingItems=function(a,b){b?-1===b.indexOf(a)&&(b=b.slice(0),b.push(a)):b=[a];var c=this.getItems(a.row,a.col,a.sizeX,a.sizeY,b);this.moveItemsDown(c,a.row+a.sizeY,b)},this.moveItemsDown=function(a,b,c){if(a&&0!==a.length){a.sort(function(a,b){return a.row-b.row}),c=c?c.slice(0):[];var d,e,f,g={};for(e=0,f=a.length;e<f;++e){d=a[e];var h=g[d.col];(void 0===h||d.row<h)&&(g[d.col]=d.row)}for(e=0,f=a.length;e<f;++e){d=a[e];var i=b-g[d.col];this.moveItemDown(d,d.row+i,c),c.push(d)}}},this.moveItemDown=function(a,b,c){if(!(a.row>=b)){for(;a.row<b;)++a.row,this.moveOverlappingItems(a,c);this.putItem(a,a.row,a.col,c)}},this.clusterItems=function(a,b){var c=e.allItems.filter(function(b){return b.group!==a.group}),d=a.row;b.sort(function(a,b){return Math.abs(a.row-d)-Math.abs(b.row-d)}),b.forEach(function(a){if(a.row<d){for(var b=a.col,f=a.sizeY,g=a.sizeX,h=null,i=a.row+1;i<d+1;){var j=[a].concat(c),k=e.getItems(i,b,g,f,j);if(0!==k.length)break;h=i,b,++i}null!==h&&(a.oldRow=a.row=h,a.setElementPosition())}else if(a.row>d){for(var b=a.col,f=a.sizeY,g=a.sizeX,h=null,i=a.row-1;i>d-1;){var j=[a].concat(c),k=e.getItems(i,b,g,f,j);if(0!==k.length)break;h=i,b,--i}null!==h&&(a.oldRow=a.row=h,a.setElementPosition())}})},this.floatItemsUp=function(){if(!(!1===this.floating||this.pushOnDrop&&e.movingItem))for(var a=0,b=this.grid.length;a<b;++a){var c=this.grid[a];if(c)for(var d=0,f=c.length;d<f;++d){var g=c[d];g&&!e.isGroupItem(g)&&this.floatItemUp(g)}}},this.floatItemUp=function(a){if(!1!==this.floating){for(var b=this.floatingSettings&&this.floatingSettings.getPageBreakPosition(),c=this.floatingSettings&&this.floatingSettings.isEditMode(),d=this.floatingSettings&&this.floatingSettings.isNewPageBreak(),e=a.col,f=a.sizeY,g=a.sizeX,h=null,i=null,j=a.row-1,k=!c&&b>0?b-1:-1;j>k;){if(0!==this.getItems(j,e,g,f,a).length){if(d&&b>0&&j>b&&!a.$element.hasClass("PAGE_BREAK")&&null!=h){var l=c?1:0,m=Math.ceil(j/b)*b+l;h=m-j-1>=f?j+1:m}break}h=j,i=e,--j}null!==h&&this.putItem(a,h,i)}},this.updateHeight=function(a){var b=this.minRows;a=a||0;for(var c=this.grid.length;c>=0;--c){var d=this.grid[c];if(d)for(var e=0,f=d.length;e<f;++e)d[e]&&(b=Math.max(b,c+a+d[e].sizeY))}this.gridHeight=this.maxRows-b>0?Math.min(this.maxRows,b):Math.max(this.maxRows,b)},this.pixelsToRows=function(a,b){return this.outerMargin?a-=this.margins[0]/2:a+=this.margins[0]/2,!0===b?Math.ceil(a/this.curRowHeight):!1===b?Math.floor(a/this.curRowHeight):Math.round(a/this.curRowHeight)},this.pixelsToColumns=function(a,b){return this.outerMargin||(a+=this.margins[1]/2),!0===b?Math.ceil(a/this.curColWidth):!1===b?Math.floor(a/this.curColWidth):Math.round(a/this.curColWidth)},this.isGroupItem=function(a){return this.movingGroup&&-1!==this.movingGroup.indexOf(a)}}]).directive("gridsterPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div>',link:function(a,b,c,d){a.previewStyle=function(){return!d.movingItem||d.pushOnDrop&&d.dropIndicator&&d.dropIndicator.hasItemsInTheWay?{display:"none"}:{display:"block",height:d.movingItem.sizeY*d.curRowHeight-d.margins[0]+"px",width:d.movingItem.sizeX*d.curColWidth-d.margins[1]+"px",top:d.movingItem.row*d.curRowHeight+(d.outerMargin?d.margins[0]:0)+"px",left:d.movingItem.col*d.curColWidth+(d.outerMargin?d.margins[1]:0)+"px"}}}}}).directive("gridsterDropIndicator",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle()" class="gridster-item gridster-preview-line"></div>',link:function(a,b,c,d){a.previewStyle=function(){return d.pushOnDrop&&d.dropIndicator&&d.dropIndicator.hasItemsInTheWay?{display:"block",height:"4px",width:d.dropIndicator.sizeX*d.curColWidth-d.margins[1]+"px",top:d.dropIndicator.row*d.curRowHeight+(d.outerMargin?d.margins[0]/2:0)+"px",left:d.dropIndicator.col*d.curColWidth+(d.outerMargin?d.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridsterGroupPreview",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="previewStyle(item)" class="gridster-item gridster-preview-holder"></div>',link:function(a,b,c,d){a.previewStyle=function(a){return!a||d.pushOnDrop&&d.dropIndicator&&d.dropIndicator.hasItemsInTheWay?{display:"none"}:{display:"block",height:a.sizeY*d.curRowHeight-d.margins[0]+"px",width:a.sizeX*d.curColWidth-d.margins[1]+"px",top:a.row*d.curRowHeight+(d.outerMargin?d.margins[0]:0)+"px",left:a.col*d.curColWidth+(d.outerMargin?d.margins[1]:0)+"px"}}}}}).directive("gridsterPlaceholder",function(){return{replace:!0,scope:!0,require:"^gridster",template:'<div ng-style="placeholderStyle(ph)" class="gridster-item gridster-placeholder"></div>',link:function(a,b,c,d){a.placeholderStyle=function(a){return d.pushOnDrop&&d.placeholders?{display:"block",height:a.sizeY*d.curRowHeight-d.margins[0]+"px",width:a.sizeX*d.curColWidth-d.margins[1]+"px",top:a.row*d.curRowHeight+(d.outerMargin?d.margins[0]:0)+"px",left:a.col*d.curColWidth+(d.outerMargin?d.margins[1]:0)+"px"}:{display:"none"}}}}}).directive("gridster",["$timeout","$window","$rootScope","gridsterDebounce",function(b,c,d,e){return{scope:!0,restrict:"EAC",controller:"GridsterCtrl",controllerAs:"gridster",compile:function(f){return f.prepend('<div ng-if="gridster.movingItem && !gridster.movingGroup" ng-class="gridster.movingItem.isNewWidget() ? \'with-icon\' : \'\'" gridster-preview></div><div ng-if="gridster.dropIndicator" gridster-drop-indicator></div><div ng-if="gridster.movingGroup" ng-repeat="item in gridster.movingGroup" gridster-group-preview></div><div ng-if="gridster.placeholders" ng-repeat="ph in gridster.placeholders" gridster-placeholder></div>'),function(f,g,h,i){function j(a,b){if(i.setOptions(a),l(g[0])){"auto"===i.width?i.curWidth=b||g[0].offsetWidth||parseInt(g.css("width"),10):i.curWidth=i.width,"auto"===i.colWidth?i.curColWidth=(i.curWidth+(i.outerMargin?-i.margins[1]:i.margins[1]))/i.columns:i.curColWidth=i.colWidth,i.curRowHeight=i.rowHeight,"string"==typeof i.rowHeight&&("match"===i.rowHeight?i.curRowHeight=Math.round(i.curColWidth):-1!==i.rowHeight.indexOf("*")?i.curRowHeight=Math.round(i.curColWidth*i.rowHeight.replace("*","").replace(" ","")):-1!==i.rowHeight.indexOf("/")&&(i.curRowHeight=Math.round(i.curColWidth/i.rowHeight.replace("/","").replace(" ","")))),i.isMobile=i.mobileModeEnabled&&i.curWidth<=i.mobileBreakPoint;for(var c=0,d=i.grid.length;c<d;++c){var e=i.grid[c];if(e)for(var f=0,h=e.length;f<h;++f)if(e[f]){var j=e[f];j.setElementPosition(),j.setElementSizeY(),j.setElementSizeX()}}k()}}function k(){g.css("height",i.gridHeight*i.curRowHeight+(i.outerMargin?i.margins[0]:-i.margins[0])+"px")}i.loaded=!1,i.$element=g,f.gridster=i,g[0].gridsterScope=function(){return f},g.addClass("gridster");var l=function(a){return"hidden"!==a.style.visibility&&"none"!==a.style.display},m=h.gridster;m?f.$parent.$watch(m,function(a){j(a)},!0):j({}),f.$watch(function(){return i.loaded},function(){i.loaded?g.addClass("gridster-loaded"):g.removeClass("gridster-loaded")}),f.$watch(function(){return i.isMobile},function(){i.isMobile?g.addClass("gridster-mobile").removeClass("gridster-desktop"):g.removeClass("gridster-mobile").addClass("gridster-desktop"),d.$broadcast("gridster-mobile-changed",i)}),f.$watch(function(){return i.draggable},function(){d.$broadcast("gridster-draggable-changed",i)},!0),f.$watch(function(){return i.resizable},function(){d.$broadcast("gridster-resizable-changed",i)},!0),f.$watch(function(){return i.gridHeight},k),f.$watch(function(){return i.movingItem},function(){i.updateHeight(i.movingItem?i.movingItem.sizeY:0)});var n=g[0].offsetWidth||parseInt(g.css("width"),10),o=function(){var a=g[0].offsetWidth||parseInt(g.css("width"),10);a&&a!==n&&!i.movingItem&&(n=a,i.loaded&&g.removeClass("gridster-loaded"),j(void 0,a),i.loaded&&g.addClass("gridster-loaded"),d.$broadcast("gridster-resized",[a,g[0].offsetHeight],i))},p=e(function(){o(),b(function(){f.$apply()})},100);f.$watch(function(){return l(g[0])},p),"function"==typeof window.addResizeListener?window.addResizeListener(g[0],p):f.$watch(function(){return g[0].offsetWidth||parseInt(g.css("width"),10)},o);var q=a.element(c);q.on("resize",p),f.$on("$destroy",function(){i.destroy(),q.off("resize",p),"function"==typeof window.removeResizeListener&&window.removeResizeListener(g[0],p)}),b(function(){f.$watch("gridster.floating",function(){i.floatItemsUp()}),i.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.group=0,this.init=function(a,b){this.$element=a,this.gridster=b,this.sizeX=b.defaultSizeX,this.sizeY=b.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this||this.gridster.isGroupItem(this)},this.setPosition=function(a,b,c){this.gridster&&(this.gridster.putItem(this,a,b,c),this.isMoving()||this.setElementPosition())},this.setSize=function(a,b,c){a=a.toUpperCase();var d="size"+a,e="Size"+a;if(""!==b){b=parseInt(b,10),(isNaN(b)||0===b)&&(b=this.gridster["default"+e]);var f="X"===a?this.gridster.columns:this.gridster.maxRows;this["max"+e]&&(f=Math.min(this["max"+e],f)),this.gridster["max"+e]&&(f=Math.min(this.gridster["max"+e],f)),"X"===a&&this.cols?f-=this.cols:"Y"===a&&this.rows&&(f-=this.rows);var g=0;this["min"+e]&&(g=Math.max(this["min"+e],g)),this.gridster["min"+e]&&(g=Math.max(this.gridster["min"+e],g)),b=Math.max(Math.min(b,f),g);var h=this[d]!==b||this["old"+e]&&this["old"+e]!==b;return this["old"+e]=this[d]=b,this.isMoving()||this["setElement"+e](),!c&&h&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),h}},this.setSizeY=function(a,b){return this.setSize("Y",a,b)},this.setSizeX=function(a,b){return this.setSize("X",a,b)},this.setElementPosition=function(){this.gridster.isMobile?this.$element.css({marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}):this.$element.css({margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]},this.isNewWidget=function(){return this.$element&&this.$element.hasClass("br-widget-placeholder")}}).factory("GridsterTouch",[function(){return function(b,c,d,e,f){var g,h,i={},j=function(a){if(Object.keys)return Object.keys(a).length;var b,c=0;for(b in a)++c;return c},k=function(a){for(var b=0,c=0,d=navigator.userAgent.match(/\bMSIE\b/),e=a;null!=e;e=e.offsetParent)d&&(!document.documentMode||document.documentMode<8)&&"relative"===e.currentStyle.position&&e.offsetParent&&"relative"===e.offsetParent.currentStyle.position&&e.offsetLeft===e.offsetParent.offsetLeft?c+=e.offsetTop:(b+=e.offsetLeft,c+=e.offsetTop);return{x:b,y:c}},l=k(b),m=function(g){if("mousemove"!==g.type||0!==j(i)){for(var h=!0,o=g.changedTouches?g.changedTouches:[g],p=0;p<o.length;++p){var q=o[p],r=void 0!==q.identifier?q.identifier:void 0!==q.pointerId?q.pointerId:1;if(void 0===q.pageX)if(q.pageX=q.offsetX+l.x,q.pageY=q.offsetY+l.y,q.srcElement.offsetParent===b&&document.documentMode&&8===document.documentMode&&"mousedown"===q.type)q.pageX+=q.srcElement.offsetLeft,q.pageY+=q.srcElement.offsetTop;else if(q.srcElement!==b&&!document.documentMode||document.documentMode<8){for(var s=-2,t=-2,u=q.srcElement;null!==u;u=u.parentNode)s+=u.scrollLeft?u.scrollLeft:0,t+=u.scrollTop?u.scrollTop:0;q.pageX=q.clientX+s,q.pageY=q.clientY+t}var v,w=q.pageX;d.draggable.container&&(v=a.element(d.draggable.container).scrollTop());var x=q.pageY+(v||0);g.type.match(/(start|down)$/i)?(l=k(b),i[r]&&(f&&f({target:g.target,which:g.which,pointerId:r,pageX:w,pageY:x}),delete i[r]),c&&h&&(h=c({target:g.target,which:g.which,pointerId:r,pageX:w,pageY:x})),i[r]={x:w,y:x},b.msSetPointerCapture&&h?b.msSetPointerCapture(r):"mousedown"===g.type&&1===j(i)&&(n?b.setCapture(!0):(document.addEventListener("mousemove",m,!1),document.addEventListener("mouseup",m,!1)))):g.type.match(/move$/i)?!i[r]||i[r].x===w&&i[r].y===x||(e&&h&&(h=e({target:g.target,which:g.which,pointerId:r,pageX:w,pageY:x})),i[r].x=w,i[r].y=x):i[r]&&g.type.match(/(up|end|cancel)$/i)&&(f&&h&&(h=f({target:g.target,which:g.which,pointerId:r,pageX:w,pageY:x})),delete i[r],b.msReleasePointerCapture?b.msReleasePointerCapture(r):"mouseup"===g.type&&0===j(i)&&(n?b.releaseCapture():(document.removeEventListener("mousemove",m,!1),document.removeEventListener("mouseup",m,!1))))}h&&(g.preventDefault&&g.preventDefault(),g.preventManipulation&&g.preventManipulation(),g.preventMouseEvent&&g.preventMouseEvent())}},n=!1;return this.enable=function(){window.navigator.pointerEnabled?(b.addEventListener("pointerdown",m,!1),b.addEventListener("pointermove",m,!1),b.addEventListener("pointerup",m,!1),b.addEventListener("pointercancel",m,!1),void 0!==b.style.msContentZooming&&(g=b.style.msContentZooming,b.style.msContentZooming="none"),void 0!==b.style.touchAction&&(h=b.style.touchAction,b.style.touchAction="none")):window.navigator.msPointerEnabled?(b.addEventListener("MSPointerDown",m,!1),b.addEventListener("MSPointerMove",m,!1),b.addEventListener("MSPointerUp",m,!1),b.addEventListener("MSPointerCancel",m,!1),void 0!==b.style.msContentZooming&&(g=b.style.msContentZooming,b.style.msContentZooming="none"),void 0!==b.style.msTouchAction&&(h=b.style.msTouchAction,b.style.msTouchAction="none")):b.addEventListener?(b.addEventListener("touchstart",m,!1),b.addEventListener("touchmove",m,!1),b.addEventListener("touchend",m,!1),b.addEventListener("touchcancel",m,!1),b.addEventListener("mousedown",m,!1),b.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(n=!0,b.addEventListener("mousemove",m,!1),b.addEventListener("mouseup",m,!1))):b.attachEvent&&b.setCapture&&(n=!0,b.attachEvent("onmousedown",function(){return m(window.event),window.event.returnValue=!1,!1}),b.attachEvent("onmousemove",function(){return m(window.event),window.event.returnValue=!1,!1}),b.attachEvent("onmouseup",function(){return m(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.pointerEnabled?(b.removeEventListener("pointerdown",m,!1),b.removeEventListener("pointermove",m,!1),b.removeEventListener("pointerup",m,!1),b.removeEventListener("pointercancel",m,!1),g&&(b.style.msContentZooming=g),h&&(b.style.touchAction=h)):window.navigator.msPointerEnabled?(b.removeEventListener("MSPointerDown",m,!1),b.removeEventListener("MSPointerMove",m,!1),b.removeEventListener("MSPointerUp",m,!1),b.removeEventListener("MSPointerCancel",m,!1),g&&(b.style.msContentZooming=g),h&&(b.style.msTouchAction=h)):b.removeEventListener?(b.removeEventListener("touchstart",m,!1),b.removeEventListener("touchmove",m,!1),b.removeEventListener("touchend",m,!1),b.removeEventListener("touchcancel",m,!1),b.removeEventListener("mousedown",m,!1),b.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(n=!0,b.removeEventListener("mousemove",m,!1),b.removeEventListener("mouseup",m,!1))):b.detachEvent&&b.setCapture&&(n=!0,b.detachEvent("onmousedown"),b.detachEvent("onmousemove"),b.detachEvent("onmouseup"))},this}}]).factory("GridsterDraggable",["$document","$window","$timeout","GridsterTouch",function(b,c,d,e){function f(f,g,h,i,j){function k(b){function c(a){return{sizeX:a.sizeX,sizeY:a.sizeY,col:a.col,row:a.row}}function e(a){return{sizeX:a.sizeX,col:a.col,row:a.row,hasItemsInTheWay:!1}}if(-1!==K.indexOf(b.target.nodeName.toLowerCase()))return!1;var g=a.element(b.target);if(g.hasClass("gridster-item-resizable-handler"))return!1;if(g.attr("onclick"))return!1;if(g.closest&&g.closest(".gridster-no-drag").length)return!1;switch(b.which){case 1:break;case 2:case 3:return}return h.movingItem||(h.movingItem=i),h.movingItem===i&&i.group&&(h.movingGroup||(h.movingGroup=h.allItems.filter(function(a){return a.group===i.group})),h.placeholders=h.movingGroup.map(c),h.pushOnDrop&&h.movingGroup.length>1?(h.clusterItems(i,h.movingGroup),d(function(){h.movingGroup.forEach(function(a){a!==i&&a.draggable.mouseDown(b)});var a=h.getElementBoundingBox(h.movingGroup);h.dropIndicator=e(a),h.masterRowOffsetInGroup=i.row-a.row},300)):h.movingGroup.forEach(function(a){a!==i&&a.draggable.mouseDown(b)})),!h.pushOnDrop||h.placeholders||h.movingGroup&&1!==h.movingGroup.length||(h.placeholders=[c(i)]),!h.pushOnDrop||h.dropIndicator||h.movingGroup&&1!==h.movingGroup.length||(h.dropIndicator=e(i)),z=b.pageX,A=b.pageY,s=parseInt(f.css("left"),10),t=parseInt(f.css("top"),10),u=f[0].offsetWidth,v=f[0].offsetHeight,I=i.col,J=i.row,n(b),!0}function l(a){if(!f.hasClass("gridster-item-moving")||f.hasClass("gridster-item-resizing"))return!1;h.movingItem===i&&i.group&&h.movingGroup.forEach(function(b){b!==i&&b.draggable.mouseMove(a)});var b=h.curWidth-1;x=a.pageX,y=a.pageY;var c=x-z+B,d=y-A+C;B=C=0,z=x,A=y;var e=c,g=d;return s+e<F?(c=F-s,B=e-c):s+u+e>b&&(c=b-s-u,B=e-c),t+g<D?(d=D-t,C=g-d):t+v+g>E&&(d=E-t-v,C=g-d),s+=c,t+=d,f.css({top:t+"px",left:s+"px"}),o(a),!0}function m(a,b){if(!f.hasClass("gridster-item-moving")||f.hasClass("gridster-item-resizing"))return!1;if(h.movingItem===i&&i.group){var c=h.movingGroup;h.movingGroup=null,c.sort(function(a,b){return b.row-a.row}).forEach(function(b){b!==i&&(h.pushOnDrop?b.draggable.mouseUp(a,!0):b.draggable.mouseUp(a))})}return B=C=0,b?r(a):q(a),!0}function n(a){f.addClass("gridster-item-moving"),h.movingItem===i&&(h.updateHeight(i.sizeY),g.$apply(function(){h.draggable&&h.draggable.start&&h.draggable.start(a,f,j,i)}))}function o(a){var b=i.row,d=i.col,e=h.draggable&&h.draggable.drag,k=h.draggable.scrollSensitivity,l=h.draggable.scrollSpeed,m=h.pixelsToRows(t),n=h.pixelsToColumns(s),o=[];if(h.pushOnDrop&&h.movingGroup&&h.movingGroup.length>1){var q=h.getElementBoundingBox(h.movingGroup);o=h.getItems(q.row,q.col,q.sizeX,q.sizeY,h.movingGroup)}else o=h.getItems(m,n,i.sizeX,i.sizeY,i);var r=0!==o.length;if(!0===h.swapping&&r){var u=h.getBoundingBox(o),v=u.sizeX===i.sizeX&&u.sizeY===i.sizeY,x=u.row===b,y=u.col===d,z=u.row===m&&u.col===n,A=x||y;if(v&&1===o.length){if(z)h.swapItems(i,o[0]);else if(A)return}else if(u.sizeX<=i.sizeX&&u.sizeY<=i.sizeY&&A)for(var B=i.row<=m?i.row:m+i.sizeY,C=i.col<=n?i.col:n+i.sizeX,D=B-u.row,E=C-u.col,F=0,H=o.length;F<H;++F){var I=o[F],J=h.getItems(I.row+D,I.col+E,I.sizeX,I.sizeY,i);0===J.length&&h.putItem(I,I.row+D,I.col+E)}}if(h.pushing&&!h.pushOnDrop||!r)i.row=m,i.col=n;else if(h.dropIndicator)if(h.pushOnDrop&&h.movingGroup&&h.movingGroup.length>1){var q=h.getElementBoundingBox(h.movingGroup);h.dropIndicator.row=p(q.row,o),h.dropIndicator.col=q.col}else h.dropIndicator.row=p(m,o),h.dropIndicator.col=n;h.dropIndicator&&(h.dropIndicator.hasItemsInTheWay=r);var K=w.scrollTop();a.pageY-K-G<k?w.scrollTop(K-l):c.innerHeight-(a.pageY-K)<k&&w.scrollTop(K+l);var L=w.scrollLeft();a.pageX-L<k?w.scrollLeft(L-l):c.innerWidth-(a.pageX-L)<k&&w.scrollLeft(L+l),h.movingItem===i&&(b===i.row&&d===i.col||g.$apply(function(){e&&h.draggable.drag(a,f,j,i)}))}function p(a,b){for(var c={top:null,bottom:null},d=0;d<b.length;d++){var e=b[d];e.row>a||((null===c.top||c.top>e.row)&&(c.top=e.row),(null===c.bottom||c.bottom<e.row+e.sizeY)&&(c.bottom=e.row+e.sizeY))}return null===c.top?a:a-c.top>(c.bottom-c.top)/2?c.bottom:c.top}function q(a){f.removeClass("gridster-item-moving");var b=h.pixelsToRows(t),c=h.pixelsToColumns(s);h.pushing&&!h.pushOnDrop||0===h.getItems(b,c,i.sizeX,i.sizeY,i).length?(i.row=b,i.col=c):h.dropIndicator&&(void 0!==h.masterRowOffsetInGroup?(i.row=h.dropIndicator.row+h.masterRowOffsetInGroup,i.col=c):(i.row=h.dropIndicator.row,i.col=h.dropIndicator.col));var d=h.movingItem===i,e=!!h.dropIndicator;if(h.movingItem=null,h.dropIndicator=null,h.placeholders=null,i.setPosition(i.row,i.col),e&&h.layoutChanged(),!d||h.pushOnDrop)return void h.moveOverlappingItems(i);g.$apply(function(){h.draggable&&h.draggable.stop&&h.draggable.stop(a,f,j,i)})}function r(a){f.removeClass("gridster-item-moving");var b=h.pixelsToRows(t),c=h.pixelsToColumns(s);h.dropIndicator.hasItemsInTheWay?(i.row=h.dropIndicator.row,i.col=c):(i.row=b,i.col=c),i.setPosition(i.row,i.col),h.moveOverlappingItems(i)}var s,t,u,v,w,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=999999,F=0,G=0;if(i.draggable=this,h.draggable.container&&(w=a.element(h.draggable.container),G=w.offset().top),!w){var H=b[0];w={scrollTop:function(a){return void 0===a?H.body.scrollTop:H.body.scrollTop=a},scrollLeft:function(a){return void 0===a?H.body.scrollLeft:H.body.scrollLeft=a}}}var I,J,K=["select","input","textarea","button"];this.mouseDown=k,this.mouseMove=l,this.mouseUp=m;var L=null,M=null,N=[];this.enable=function(){!0!==L&&(L=!0,f.ready(function(){if(!0===L){for(var b=0,c=N.length;b<c;++b)N[b].disable();N=[],h.draggable&&h.draggable.handle?(M=a.element(f[0].querySelectorAll(h.draggable.handle)),0===M.length&&(M=f)):M=f;for(var d=0,g=M.length;d<g;++d)N[d]=new e(M[d],k,h,l,m),N[d].enable()}}))},this.disable=function(){if(!1!==L){L=!1;for(var a=0,b=N.length;a<b;++a)N[a].disable();N=[]}},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){this.disable()}}return f}]).factory("GridsterResizable",["GridsterTouch",function(b){function c(c,d,e,f,g){function h(h){function i(a){switch(a.which){case 1:break;case 2:case 3:return}return u=e.draggable.enabled,u&&(e.draggable.enabled=!1,d.$broadcast("gridster-draggable-changed",e)),z=a.pageX,A=a.pageY,o=parseInt(c.css("left"),10),p=parseInt(c.css("top"),10),q=c[0].offsetWidth,r=c[0].offsetHeight,s=f.sizeX,t=f.sizeY,j(a),!0}function j(a){c.addClass("gridster-item-moving"),c.addClass("gridster-item-resizing"),e.movingItem=f,e.resizingItem=f,f.setElementSizeX(),f.setElementSizeY(),f.setElementPosition(),e.updateHeight(1),d.$apply(function(){e.resizable&&e.resizable.start&&e.resizable.start(a,c,g,f)})}function k(a){var b=e.curWidth-1;x=a.pageX,y=a.pageY;var d=x-z+B,f=y-A+C;B=C=0,z=x,A=y;var g=f,h=d;return w.indexOf("n")>=0&&(r-g<G()?(f=r-G(),C=g-f):p+g<D&&(f=D-p,C=g-f),p+=f,r-=f),w.indexOf("s")>=0&&(r+g<G()?(f=G()-r,C=g-f):p+r+g>E&&(f=E-p-r,C=g-f),r+=f),w.indexOf("w")>=0&&(q-h<H()?(d=q-H(),B=h-d):o+h<F&&(d=F-o,B=h-d),o+=d,q-=d),w.indexOf("e")>=0&&(q+h<H()?(d=H()-q,B=h-d):o+q+h>b&&(d=b-o-q,B=h-d),q+=d),c.css({top:p+"px",left:o+"px",width:q+"px",height:r+"px"}),m(a),!0}function l(a){return e.draggable.enabled!==u&&(e.draggable.enabled=u,d.$broadcast("gridster-draggable-changed",e)),B=C=0,n(a),!0}function m(a){var b=f.row,i=f.col,j=f.sizeX,k=f.sizeY,l=e.resizable&&e.resizable.resize,m=f.col;-1!==["w","nw","sw"].indexOf(h)&&(m=e.pixelsToColumns(o,!1));var n=f.row;-1!==["n","ne","nw"].indexOf(h)&&(n=e.pixelsToRows(p,!1));var s=f.sizeX;-1===["n","s"].indexOf(h)&&(s=e.pixelsToColumns(q,!0));var t=f.sizeY;-1===["e","w"].indexOf(h)&&(t=e.pixelsToRows(r,!0)),!(n>-1&&m>-1&&s+m<=e.columns&&t+n<=e.maxRows)||!1===e.pushing&&0!==e.getItems(n,m,s,t,f).length||(f.row=n,f.col=m,f.sizeX=s,f.sizeY=t),(f.row!==b||f.col!==i||f.sizeX!==j||f.sizeY!==k)&&d.$apply(function(){l&&e.resizable.resize(a,c,g,f)})}function n(a){c.removeClass("gridster-item-moving"),c.removeClass("gridster-item-resizing"),e.movingItem=null,e.resizingItem=null,f.setPosition(f.row,f.col),f.setSizeY(f.sizeY),f.setSizeX(f.sizeX),e.pushOnDrop&&e.layoutChanged(),d.$apply(function(){e.resizable&&e.resizable.stop&&e.resizable.stop(a,c,g,f)})}var o,p,q,r,s,t,u,v,w=h,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=999999,F=0,G=function(){return(f.minSizeY?f.minSizeY:1)*e.curRowHeight-e.margins[0]},H=function(){return(f.minSizeX?f.minSizeX:1)*e.curColWidth-e.margins[1]},I=null;this.enable=function(){I||(I=a.element('<div class="gridster-item-resizable-handler handle-'+w+'"></div>'),c.append(I)),v=new b(I[0],i,e,k,l),v.enable()},this.disable=function(){I&&(I.remove(),I=null),v.disable(),v=void 0},this.destroy=function(){this.disable()}}var i=[],j=e.resizable.handles;"string"==typeof j&&(j=e.resizable.handles.split(","));for(var k=!1,l=0,m=j.length;l<m;l++)i.push(new h(j[l]));this.enable=function(){if(!k){for(var a=0,b=i.length;a<b;a++)i[a].enable();k=!0}},this.disable=function(){if(k){for(var a=0,b=i.length;a<b;a++)i[a].disable();k=!1}},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){for(var a=0,b=i.length;a<b;a++)i[a].destroy()}}return c}]).factory("gridsterDebounce",function(){return function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}}).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable","gridsterDebounce",function(a,b,c,d){return{scope:!0,restrict:"EA",controller:"GridsterItemCtrl",controllerAs:"gridsterItem",require:["^gridster","gridsterItem"],link:function(e,f,g,h){function i(){n.pushOnDrop&&n.movingGroup&&n.movingGroup.length>1||(o.setPosition(o.row,o.col,n.movingGroup),r.row&&r.row.assign&&r.row.assign(e,o.row),r.col&&r.col.assign&&r.col.assign(e,o.col))}function j(){var a=o.setSizeX(o.sizeX,!0);a&&r.sizeX&&r.sizeX.assign&&r.sizeX.assign(e,o.sizeX);var b=o.setSizeY(o.sizeY,!0);b&&r.sizeY&&r.sizeY.assign&&r.sizeY.assign(e,o.sizeY),(a||b)&&(o.gridster.moveOverlappingItems(o),n.layoutChanged(),e.$broadcast("gridster-item-resized",o))}function k(){var a=document.createElement("div"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var c in b)if(void 0!==a.style[c])return b[c]}var l,m=g.gridsterItem,n=h[0],o=h[1];if(e.gridster=n,m){var p=a(m);l=p(e)||{},!l&&p.assign&&(l={row:o.row,col:o.col,sizeX:o.sizeX,sizeY:o.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null,group:0},p.assign(e,l))}else l=g;o.init(f,n),f.addClass("gridster-item");for(var q=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col","group"],r={},s=[],t=function(b){var c;if("string"==typeof l[b])c=l[b];else if("string"==typeof l[b.toLowerCase()])c=l[b.toLowerCase()];else{if(!m)return;c=m+"."+b}s.push('"'+b+'":'+c),r[b]=a(c);var d=r[b](e);"number"==typeof d&&(o[b]=d)},u=0,v=q.length;u<v;++u)t(q[u]);var w="{"+s.join(",")+"}";e.$watchCollection(w,function(a,b){for(var c in a){var d=a[c];b[c]!==d&&(d=parseInt(d,10),isNaN(d)||(o[c]=d))}}),e.$watch(function(){return o.row+","+o.col},i),e.$watch(function(){return o.sizeY+","+o.sizeX+","+o.minSizeX+","+o.maxSizeX+","+o.minSizeY+","+o.maxSizeY},j);var x=new b(f,e,n,o,l),y=new c(f,e,n,o,l),z=function(){y.toggle(!n.isMobile&&n.resizable&&n.resizable.enabled)};z();var A=function(){x.toggle(!n.isMobile&&n.draggable&&n.draggable.enabled)};A(),e.$on("gridster-draggable-changed",A),e.$on("gridster-resizable-changed",z),e.$on("gridster-resized",z),e.$on("gridster-mobile-changed",function(){z(),A()});var B=d(function(){e.$apply(function(){e.$broadcast("gridster-item-transition-end",o)})},50);return f.on(k(),B),e.$broadcast("gridster-item-initialized",o),e.$on("$destroy",function(){try{y.destroy(),x.destroy()}catch(a){}try{n.removeItem(o)}catch(a){}try{o.destroy()}catch(a){}})}}}]).directive("gridsterNoDrag",function(){return{restrict:"A",link:function(a,b){b.addClass("gridster-no-drag")}}})});